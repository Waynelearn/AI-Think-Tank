<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Think Tank</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>AI Think Tank</h1>
            <p class="subtitle">A round-table of AI minds discussing your topics
                <a href="/help" class="help-link" title="How to use AI Think Tank">?</a>
                <a href="/admin" class="help-link" title="Usage dashboard">&#128202;</a>
            </p>
        </header>

        <!-- Settings Panel (collapsible) -->
        <div class="settings-panel">
            <button class="settings-toggle" id="settings-toggle">&#9881; Settings &#9660;</button>
            <div class="settings-body" id="settings-body">
                <div class="settings-row">
                    <label for="provider-select">Provider</label>
                    <select id="provider-select"></select>
                </div>
                <div class="settings-row">
                    <label for="model-select">Model</label>
                    <select id="model-select"></select>
                </div>
                <div class="settings-row">
                    <label for="api-key-provider">API Key</label>
                    <input type="password" id="api-key-provider" placeholder="sk-ant-..." autocomplete="off">
                </div>
                <div class="settings-row">
                    <label for="api-key-brave">Brave Search Key</label>
                    <input type="password" id="api-key-brave" placeholder="BSA..." autocomplete="off">
                </div>
                <div class="settings-actions">
                    <button id="settings-save" class="settings-btn">Save</button>
                    <button id="settings-clear" class="settings-btn settings-btn-danger">Clear</button>
                </div>
                <div class="settings-notice" id="settings-notice"></div>
            </div>
        </div>

        <!-- Usage Bar -->
        <div class="usage-bar" id="usage-bar" style="display:none;">
            <span id="usage-text">Tokens: 0 in / 0 out</span>
            <span id="usage-cost">~$0.00</span>
        </div>

        <div class="agents-bar" id="agents-bar"></div>

        <div class="main-area">
            <!-- Queue toggle (mobile only) -->
            <button id="queue-toggle" class="queue-toggle">Speaker Queue &#9660;</button>

            <!-- Queue Panel (right side) -->
            <div class="queue-panel" id="queue-panel">
                <div class="queue-header">
                    <span class="queue-title">Speaker Queue</span>
                    <span class="queue-round" id="queue-round">Round 1</span>
                </div>
                <div class="queue-list" id="queue-list"></div>
                <div class="queue-actions">
                    <button id="btn-play" class="q-btn q-play" title="Auto-run all in queue">&#9654; Play All</button>
                    <button id="btn-next" class="q-btn q-next" title="Run next agent">&#9199; Next</button>
                    <button id="btn-new-round" class="q-btn" title="Start a new round">&#10227; New Round</button>
                    <button id="btn-end" class="q-btn q-end" title="Stop auto-play">&#9724; Stop</button>
                    <button id="btn-clear" class="q-btn" title="Clear all agents from queue">&#128465; Clear</button>
                </div>
                <div class="queue-add">
                    <select id="add-agent-select"><option value="">+ Add agent...</option></select>
                    <button id="btn-add-agent" class="q-btn-sm">Add</button>
                </div>
            </div>

            <!-- Chat Area -->
            <div class="chat-area" id="chat-area">
                <div class="welcome-message">
                    <p>Select agents above, enter a topic, and control the discussion with the queue panel.</p>
                    <p class="welcome-sub">Click agents to toggle. Drag queue items to reorder. Interject anytime.</p>
                </div>
            </div>
        </div>

        <div class="input-area">
            <div class="controls">
                <button id="btn-new-chat" class="icon-btn" title="Start a fresh discussion">&#10010; New Chat</button>
                <label for="file-upload" class="file-upload-btn" title="Attach files">&#128206; Attach</label>
                <input type="file" id="file-upload" multiple hidden
                    accept=".csv,.xlsx,.xls,.pdf,.html,.htm,.txt,.md,.json,.log,.py,.js,.ts,.docx,.png,.jpg,.jpeg,.gif,.webp,.mp4,.mov,.avi,.mkv">
                <span id="file-status" class="file-status"></span>
                <select id="save-format" class="icon-btn" title="Save format">
                    <option value="html">Save as HTML</option>
                    <option value="json">Save as JSON</option>
                </select>
                <button id="download-btn" class="icon-btn" title="Download conversation" disabled>&#128190; Save</button>
                <button id="load-btn" class="icon-btn" title="Load previous conversation">&#128194; Load</button>
                <input type="file" id="load-input" accept=".json,.html" hidden>
            </div>
            <div class="input-row">
                <textarea id="topic-input" rows="1" placeholder="Enter a topic for discussion..." autocomplete="off"></textarea>
                <button id="submit-btn">Start</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
